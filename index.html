<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AI EduBrain Demo</title>

  <link rel="icon" href="./assets/favicon.svg?v=093" />
  <link rel="stylesheet" href="./assets/app.css?v=093" />
  <meta name="theme-color" content="#4f46e5" />

  <script defer src="./assets/app.js?v=093"></script>
</head>

<body>
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="logo-area">
      <div class="logo-icon">
        <!-- 数字人 icon（纯 SVG） -->
        <svg width="36" height="36" viewBox="0 0 64 64" aria-hidden="true">
          <defs>
            <radialGradient id="g1" cx="30%" cy="30%" r="80%">
              <stop offset="0%" stop-color="#A5B4FC"/>
              <stop offset="45%" stop-color="#6366F1"/>
              <stop offset="100%" stop-color="#4F46E5"/>
            </radialGradient>
          </defs>
          <circle cx="32" cy="32" r="30" fill="url(#g1)" opacity="0.18"></circle>
          <circle cx="32" cy="32" r="24" fill="url(#g1)"></circle>
          <circle cx="26" cy="30" r="3" fill="#fff"></circle>
          <circle cx="38" cy="30" r="3" fill="#fff"></circle>
          <path d="M24 40c3.5 3 7.3 4.5 8 4.5S36.5 43 40 40" fill="none" stroke="#fff" stroke-width="3" stroke-linecap="round"/>
          <path d="M18 22c4-6 10-10 14-10s10 4 14 10" fill="none" stroke="rgba(255,255,255,0.65)" stroke-width="3" stroke-linecap="round"/>
        </svg>
      </div>

      <div class="logo-text">
        <div class="logo-title">AI EduBrain</div>
        <div class="logo-sub">K12 学段成长智能体</div>
      </div>

      <span class="badge" id="app-version">v0.9.3-demo</span>
    </div>

    <nav class="nav-menu" id="nav-menu">
      <button class="nav-item active" data-view="home">
        <span class="nav-icon">🏠</span><span>首页入口</span>
      </button>
      <button class="nav-item" data-view="teacher">
        <span class="nav-icon">🧑‍🏫</span><span>教师工作台</span>
      </button>
      <button class="nav-item" data-view="student">
        <span class="nav-icon">🎓</span><span>学习伴侣</span>
      </button>
      <button class="nav-item" data-view="gov">
        <span class="nav-icon">🌍</span><span>治理驾驶舱</span>
      </button>
    </nav>

    <div class="user-profile">
      <div class="avatar">李</div>
      <div class="user-meta">
        <div class="user-name">李老师</div>
        <div class="user-sub">数学组 · 初二</div>
      </div>
    </div>
  </aside>

  <!-- Main -->
  <main class="main">
    <header class="top-header" id="top-header">
      <div class="crumbs">工作区 / <span id="page-title">首页入口</span></div>
      <div class="status-pill">
        <span class="dot"></span> 系统正常
      </div>
    </header>

    <section class="view-wrap">
      <!-- HOME -->
      <div class="view active" id="view-home">
        <div class="home-hero">
          <h1>今天想做点什么？</h1>
          <p>全链路教育大模型已就绪</p>

          <div class="home-search">
            <input id="home-input" class="magic-input" placeholder="输入：'帮我备课' 或 '批改作业'" />
            <button class="btn btn-primary" id="home-go">开始</button>
          </div>

          <div class="card-grid">
            <div class="feature-card" data-action="goto-teacher-prep">
              <div class="fc-emoji">📘</div>
              <div class="fc-title">智能备课</div>
              <div class="fc-sub">生成可视化教案</div>
            </div>

            <div class="feature-card" data-action="goto-teacher-mark">
              <div class="fc-emoji">✍️</div>
              <div class="fc-title">作业批改</div>
              <div class="fc-sub">OCR 扫描诊断</div>
            </div>

            <div class="feature-card" data-action="goto-student">
              <div class="fc-emoji">🎧</div>
              <div class="fc-title">学习伴侣</div>
              <div class="fc-sub">成长档案 + 自主学习问答</div>
            </div>
          </div>
        </div>
      </div>

      <!-- TEACHER -->
      <div class="view" id="view-teacher">
        <div class="teacher-toolbar">
          <button class="btn btn-primary" id="btn-prep" data-mode="prep">📚 备课模式</button>
          <button class="btn btn-ghost" id="btn-mark" data-mode="mark">✍️ 批改模式</button>
          <button class="btn btn-ghost" id="btn-review" data-mode="review">🧠 教研复盘</button>
        </div>

        <div class="teacher-layout">
          <!-- left: chat -->
          <div class="panel chat-panel">
            <div class="panel-hd">AI 教学助手</div>

            <div class="chat-box" id="chat-box">
              <div class="msg ai">
                <div class="bubble">李老师好！我是您的智能备课助理。</div>
              </div>
            </div>

            <div class="chat-input">
              <input id="teacher-input" placeholder="输入指令：如 '生成分数应用题教学设计' 或 '查看本周异常'" />
              <button class="btn btn-primary" id="teacher-send">发送</button>
            </div>
          </div>

          <!-- right: workspace + analytics -->
          <div class="panel work-panel">
            <div class="panel-hd">📌 教学工作区</div>

            <!-- workspace area -->
            <div class="work-area" id="work-area">
              <div class="work-placeholder" id="prep-placeholder">
                <div class="spark">✨</div>
                <div class="ph-title">AI 魔法准备中</div>
                <div class="ph-sub">选择左侧模式并输入指令开始</div>
              </div>

              <div id="lesson-result" style="display:none;"></div>

              <div id="ocr-interface" class="ocr" style="display:none;">
                <div class="ocr-tip" id="ocr-tip">📸 点击屏幕模拟扫描</div>
                <div class="paper">
                  <h3>数学单元测试</h3>
                  <p>
                    1. 1/2 + 1/3 = 5/6 (✓)<br />
                    2. 甲是乙的 3/4...<br />
                    &nbsp;&nbsp;20 ÷ 3/4 = 80/3 (✗)
                  </p>
                  <div class="error-spot" id="ocr-error"></div>
                </div>
                <div class="scan-laser" id="scan-laser"></div>
              </div>

              <!-- 教研复盘 -->
              <div id="review-board" class="review-board" style="display:none;">
                <div class="review-top">
                  <div class="review-title">🧠 本周教研复盘（示例）</div>
                  <div class="review-sub">基于错因聚类 + 学情波动 + 异常触发，自动生成可执行教研动作</div>
                </div>

                <div class="review-kpis">
                  <div class="review-kpi">
                    <div class="rk-name">高频错因 Top1</div>
                    <div class="rk-val">审题误读</div>
                    <div class="rk-sub">影响 6 人（B/C 组为主）</div>
                  </div>
                  <div class="review-kpi">
                    <div class="rk-name">薄弱知识点</div>
                    <div class="rk-val">分数乘除</div>
                    <div class="rk-sub">错误率 38%（较上周 +7%）</div>
                  </div>
                  <div class="review-kpi">
                    <div class="rk-name">建议教研动作</div>
                    <div class="rk-val">讲评脚本</div>
                    <div class="rk-sub">可一键生成并下发练习包</div>
                  </div>
                </div>

                <div class="review-list" id="review-list"></div>
              </div>
            </div>

            <!-- KPI -->
            <div class="kpi-row">
              <div class="kpi-card">
                <div class="kpi-name">今日批改</div>
                <div class="kpi-val" id="kpi-marked">18</div>
                <div class="kpi-sub">已完成 / 共 32</div>
              </div>
              <div class="kpi-card">
                <div class="kpi-name">近7天掌握度</div>
                <div class="kpi-val"><span id="kpi-mastery">73</span>%</div>
                <div class="kpi-sub">较上周 <span class="pos">+2%</span></div>
              </div>
              <div class="kpi-card kpi-warn">
                <div class="kpi-name">异常预警</div>
                <div class="kpi-val" id="kpi-anomaly">3</div>
                <div class="kpi-sub">可点击钻取详情</div>
              </div>
            </div>

            <!-- 联动分析区 -->
            <div class="insight-grid">
              <div class="insight-card" id="trend-card">
                <div class="insight-hd">
                  <div class="insight-title">📈 班级趋势（近7天掌握度）</div>
                  <div class="insight-sub">点击折线点位 → 联动分层 / 异常 / 名单高亮</div>
                </div>
                <div class="trend-wrap">
                  <svg id="trend-svg" class="trend-svg" viewBox="0 0 520 160" preserveAspectRatio="none"></svg>
                </div>
              </div>

              <div class="insight-card" id="layer-card">
                <div class="insight-hd">
                  <div class="insight-title">👥 班级分层（A/B/C）</div>
                  <div class="insight-sub">用于作业分层、精准补救、拔高提升</div>
                </div>
                <div class="layers" id="layers"></div>

                <div class="mini-divider"></div>

                <div class="roster-hd">
                  <div class="roster-title">📋 班级名单</div>
                  <button class="chip chip-ghost" id="btn-clear-filter">清除筛选</button>
                </div>

                <div class="roster-search">
                  <input id="roster-search" placeholder="搜索学生（如：王晨）" />
                </div>
                <div class="roster-list" id="roster"></div>
              </div>

              <div class="insight-card" id="anomaly-card">
                <div class="insight-hd">
                  <div class="insight-title">⚠️ 异常钻取</div>
                  <div class="insight-sub">点击异常 → 进入详情与建议动作</div>
                </div>

                <div class="chips" id="anomaly-filters"></div>
                <div class="anomaly-list" id="anomaly-list"></div>
              </div>
            </div>

            <!-- 任务中心（新增） -->
            <div class="task-center">
              <div class="task-hd">
                <div class="task-title">📤 任务中心（下发 / 记录 / 可复制）</div>
                <div class="task-actions">
                  <button class="chip chip-ghost" id="task-filter-all">全部</button>
                  <button class="chip chip-ghost" id="task-filter-draft">草稿</button>
                  <button class="chip chip-ghost" id="task-filter-sent">已下发</button>
                </div>
              </div>
              <div class="task-sub">来自：异常钻取 / 分层钻取 / 学生画像 → 一键生成可执行任务</div>
              <div class="task-list" id="task-list"></div>
            </div>

          </div>
        </div>
      </div>

      <!-- STUDENT -->
      <div class="view" id="view-student">
        <div class="student-header">
          <div>
            <h2>👋 早上好，<span id="student-name">小明</span></h2>
            <p class="muted">你的学习伴侣已完成本周诊断与建议更新</p>
          </div>
          <div class="streak" id="student-streak">🔥 打卡 12 天</div>
        </div>

        <div class="student-grid">
          <div class="panel student-card">
            <div class="panel-hd">🎯 成长档案</div>
            <div class="profile-body">
              <div class="profile-kpis">
                <div class="mini-kpi">
                  <div class="mk-name">数学掌握度</div>
                  <div class="mk-val"><span id="st-math">76</span>%</div>
                </div>
                <div class="mini-kpi">
                  <div class="mk-name">本周错题</div>
                  <div class="mk-val" id="st-wrong">14</div>
                </div>
                <div class="mini-kpi">
                  <div class="mk-name">学习分层</div>
                  <div class="mk-val" id="st-group">B+</div>
                </div>
              </div>

              <div class="timeline" id="student-timeline"></div>

              <div class="actions">
                <button class="btn btn-primary" id="btn-student-ask">立即问答</button>
                <button class="btn btn-ghost" id="btn-student-review">查看错题本</button>
              </div>
            </div>
          </div>

          <div class="panel student-card">
            <div class="panel-hd">💬 即时自主学习问答</div>
            <div class="qa-box" id="qa-box">
              <div class="msg ai"><div class="bubble">你可以拍照/语音/文字提问。我会按步骤讲解，并给你同类巩固。</div></div>
            </div>
            <div class="chat-input">
              <input id="student-input" placeholder="例如：这道几何题怎么做？/ 帮我改作文" />
              <button class="btn btn-primary" id="student-send">发送</button>
            </div>
          </div>
        </div>
      </div>

      <!-- GOV -->
      <div class="view" id="view-gov">
        <div class="gov-hero">
          <div class="gov-title">🏙️ 区域教育大脑</div>
          <div class="gov-kpi">
            <div class="big">92.4%</div>
            <div class="sub">AI 备课覆盖率</div>
          </div>
        </div>

        <div class="gov-grid">
          <div class="panel gov-card">
            <div class="panel-hd">⚡ 实时动态</div>
            <div class="feed" id="feed-list"></div>
          </div>
          <div class="panel gov-card">
            <div class="panel-hd">🌐 区域态势</div>
            <div class="gov-map" id="gov-map"></div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- 抽屉钻取 -->
  <div class="drawer-backdrop" id="drawer-backdrop"></div>
  <aside class="drawer" id="drawer">
    <div class="drawer-hd">
      <div class="drawer-title" id="drawer-title">钻取详情</div>
      <button class="icon-btn" id="drawer-close">✕</button>
    </div>
    <div class="drawer-body" id="drawer-body"></div>
  </aside>

  <!-- Toast -->
  <div class="toast" id="toast"></div>
</body>
</html>
