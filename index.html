<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI EduBrain | K12 教育智能体演示</title>

    <!-- 关键：资源都在 assets 下 -->
    <link rel="stylesheet" href="/assets/app.css" />
    <link rel="icon" href="/assets/favicon.svg" type="image/svg+xml" />
  </head>

  <body>
    <!-- 顶部栏 -->
    <header class="topbar">
      <div class="brand">
        <div class="brand__logo">
          <img src="/assets/digital-human.svg" alt="AI EduBrain" />
        </div>
        <div class="brand__text">
          <div class="brand__title">AI EduBrain</div>
          <div class="brand__sub">K12 教育智能体演示</div>
        </div>
      </div>

      <div class="topbar__actions">
        <button class="btn btn--ghost" id="btnSwitchRole">切换身份</button>
      </div>
    </header>

    <main class="layout">
      <!-- 左侧导航 -->
      <aside class="sidebar">
        <div class="sidebar__meta">
          <div class="meta__ver">v0.9.3</div>
          <div class="meta__status" id="systemStatus">系统正常</div>
        </div>

        <nav class="nav">
          <div class="nav__group">
            <button class="nav__item active" data-view="home" id="navHome">
              🏠 首页入口
            </button>
          </div>

          <div class="nav__group" id="navGroupRole">
            <!-- 三角色入口：JS 会根据身份显示其一 -->
            <button class="nav__item" data-view="teacher" id="navTeacher">
              👩‍🏫 教师工作台
            </button>
            <button class="nav__item" data-view="student" id="navStudent">
              🧑‍🎓 学习伴侣
            </button>
            <button class="nav__item" data-view="gov" id="navGov">
              🏛️ 治理驾驶舱
            </button>
          </div>
        </nav>

        <div class="sidebar__profile">
          <div class="profile__name" id="profileName">未选择身份</div>
          <div class="profile__desc" id="profileDesc">请选择老师 / 学生 / 教育管理者</div>
        </div>
      </aside>

      <!-- 右侧内容区 -->
      <section class="content">
        <!-- 首页 -->
        <div class="view view--active" id="view-home">
          <h1 class="h1">今天想做点什么？</h1>
          <p class="muted">系统已按身份隔离，仅展示你所属角色的业务入口。</p>

          <div class="quick">
            <div class="quick__item">
              <div class="quick__title">老师</div>
              <div class="quick__desc">看趋势 / 查作业 / 诊断薄弱点</div>
              <button class="btn" onclick="setRole('teacher')">以老师身份进入</button>
            </div>

            <div class="quick__item">
              <div class="quick__title">学生</div>
              <div class="quick__desc">问题解答 / 错题订正 / 学习计划</div>
              <button class="btn" onclick="setRole('student')">以学生身份进入</button>
            </div>

            <div class="quick__item">
              <div class="quick__title">教育管理者</div>
              <div class="quick__desc">区校指标 / 风险预警 / 治理建议</div>
              <button class="btn" onclick="setRole('gov')">以管理者身份进入</button>
            </div>
          </div>
        </div>

        <!-- 教师工作台 -->
        <div class="view" id="view-teacher">
          <h1 class="h1">教师工作台</h1>
          <p class="muted">聚焦：备课提效、作业批改、学情诊断、班级管理。</p>

          <div class="cards">
            <div class="card">
              <div class="card__title">智能备课</div>
              <div class="card__desc">一句话生成教案大纲 + 课堂活动 + 分层练习题。</div>
              <button class="btn btn--primary">进入</button>
            </div>

            <div class="card">
              <div class="card__title">作业批改</div>
              <div class="card__desc">OCR 扫描 + 错因定位 + 个性化讲评建议。</div>
              <button class="btn btn--primary">进入</button>
            </div>

            <div class="card">
              <div class="card__title">学情分析</div>
              <div class="card__desc">班级薄弱点热力图 + 分层干预策略。</div>
              <button class="btn btn--primary">进入</button>
            </div>
          </div>
        </div>

        <!-- 学习伴侣 -->
        <div class="view" id="view-student">
          <h1 class="h1">学习伴侣</h1>
          <p class="muted">聚焦：答疑、错题、学习路径、学习陪伴。</p>

          <div class="cards">
            <div class="card">
              <div class="card__title">拍题答疑</div>
              <div class="card__desc">先引导思路，再给步骤，最后给同类题巩固。</div>
              <button class="btn btn--primary">进入</button>
            </div>

            <div class="card">
              <div class="card__title">错题本</div>
              <div class="card__desc">自动归类知识点，生成复习清单与闯关练习。</div>
              <button class="btn btn--primary">进入</button>
            </div>

            <div class="card">
              <div class="card__title">学习计划</div>
              <div class="card__desc">目标拆解 + 每日任务 + 自测反馈闭环。</div>
              <button class="btn btn--primary">进入</button>
            </div>
          </div>
        </div>

        <!-- 治理驾驶舱 -->
        <div class="view" id="view-gov">
          <h1 class="h1">治理驾驶舱</h1>
          <p class="muted">聚焦：教育治理、质量监测、风险预警、资源调度。</p>

          <div class="cards">
            <div class="card">
              <div class="card__title">指标总览</div>
              <div class="card__desc">学业质量、作业负担、出勤、心理预警等核心指标。</div>
              <button class="btn btn--primary">进入</button>
            </div>

            <div class="card">
              <div class="card__title">风险预警</div>
              <div class="card__desc">异常波动识别：成绩下滑、缺勤、舆情、心理风险。</div>
              <button class="btn btn--primary">进入</button>
            </div>

            <div class="card">
              <div class="card__title">治理建议</div>
              <div class="card__desc">可执行动作：督导 / 教研 / 资源倾斜 / 专项提升。</div>
              <button class="btn btn--primary">进入</button>
            </div>
          </div>
        </div>
      </section>
    </main>

    <!-- 身份选择弹窗 -->
    <div class="modal" id="roleModal" aria-hidden="true">
      <div class="modal__mask" onclick="closeRoleModal()"></div>
      <div class="modal__panel">
        <div class="modal__head">
          <div class="modal__title">选择身份</div>
          <button class="btn btn--ghost" onclick="closeRoleModal()">关闭</button>
        </div>

        <div class="modal__body">
          <div class="roleGrid">
            <button class="roleBtn" onclick="setRole('teacher')">
              👩‍🏫 老师
              <span>备课 / 批改 / 学情</span>
            </button>

            <button class="roleBtn" onclick="setRole('student')">
              🧑‍🎓 学生
              <span>答疑 / 错题 / 计划</span>
            </button>

            <button class="roleBtn" onclick="setRole('gov')">
              🏛️ 教育管理者
              <span>指标 / 预警 / 治理</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- 关键：JS 在 assets 下 -->
    <script src="/assets/app.js"></script>

    <script>
      // 兜底：如果 app.js 没加载（路径404），这里会提示你排查资源路径
      window.addEventListener("error", function () {
        const status = document.getElementById("systemStatus");
        if (status) status.textContent = "资源加载异常（请检查 /assets/app.js 与 /assets/app.css）";
      });

      // 切换身份：清掉缓存并打开身份弹窗
      document.getElementById("btnSwitchRole")?.addEventListener("click", function () {
        try {
          localStorage.removeItem("edubrain_role");
        } catch (e) {}
        openRoleModal();
      });

      // 首次进入：没有身份就弹窗，有身份就按身份渲染
      document.addEventListener("DOMContentLoaded", function () {
        try {
          const role = localStorage.getItem("edubrain_role");
          if (!role) openRoleModal();
          else {
            if (typeof applyRoleUI === "function") applyRoleUI(role);
            if (typeof switchView === "function") switchView("home");
          }
        } catch (e) {
          openRoleModal();
        }
      });

      // 弹窗兜底（就算 app.js 没写这俩函数，这里也能用）
      function openRoleModal() {
        const m = document.getElementById("roleModal");
        if (!m) return;
        m.classList.add("modal--open");
        m.setAttribute("aria-hidden", "false");
      }

      function closeRoleModal() {
        const m = document.getElementById("roleModal");
        if (!m) return;
        m.classList.remove("modal--open");
        m.setAttribute("aria-hidden", "true");
      }
    </script>
  </body>
</html>
